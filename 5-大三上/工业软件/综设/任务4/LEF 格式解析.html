<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LEF 格式解析教学材料</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #2c3e50, #4a6491);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .content {
            display: flex;
            flex-wrap: wrap;
            padding: 20px;
        }
        
        .main-content {
            flex: 3;
            min-width: 300px;
            padding: 20px;
        }
        
        .sidebar {
            flex: 1;
            min-width: 250px;
            background-color: #f0f4f8;
            padding: 20px;
            border-radius: 8px;
            margin: 10px;
        }
        
        h2 {
            color: #2c3e50;
            margin: 25px 0 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eaecef;
        }
        
        h3 {
            color: #3498db;
            margin: 20px 0 10px;
        }
        
        p {
            margin-bottom: 15px;
        }
        
        ul, ol {
            margin-left: 20px;
            margin-bottom: 15px;
        }
        
        li {
            margin-bottom: 8px;
        }
        
        .code-block {
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
        }
        
        .highlight {
            background-color: #fffacd;
            padding: 2px 5px;
            border-radius: 3px;
            font-weight: bold;
        }
        
        .example-box {
            background-color: #edf2f7;
            border-left: 4px solid #4299e1;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 5px 5px 0;
        }
        
        .task-section {
            background-color: #e8f4fc;
            border-radius: 8px;
            padding: 20px;
            margin: 25px 0;
            border: 1px solid #bee3f8;
        }
        
        .task-title {
            color: #2b6cb0;
            font-size: 1.5rem;
            margin-bottom: 15px;
        }
        
        .step {
            background-color: white;
            padding: 12px;
            margin: 10px 0;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .step-number {
            display: inline-block;
            background-color: #4299e1;
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            text-align: center;
            margin-right: 10px;
            line-height: 25px;
        }
        
        .note {
            background-color: #fff9db;
            border-left: 4px solid #f59f00;
            padding: 10px 15px;
            margin: 15px 0;
            border-radius: 0 5px 5px 0;
        }
        
        .macro-diagram {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            text-align: center;
        }
        
        .layer-info {
            display: flex;
            flex-wrap: wrap;
            margin: 10px 0;
        }
        
        .layer-item {
            flex: 1;
            min-width: 200px;
            background-color: #f1f8ff;
            padding: 10px;
            margin: 5px;
            border-radius: 5px;
            border-left: 3px solid #0366d6;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            background-color: #2c3e50;
            color: white;
            margin-top: 30px;
        }
        
        @media (max-width: 768px) {
            .content {
                flex-direction: column;
            }
            
            .sidebar {
                margin: 10px 0;
            }
            
            .layer-item {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>LEF 格式解析教学材料</h1>
            <p class="subtitle">集成电路物理设计的工艺库描述格式</p>
        </header>
        
        <div class="content">
            <div class="main-content">
                <h2>LEF 格式概述</h2>
                <p><span class="highlight">LEF（Library Exchange Format）</span>是集成电路物理设计中的关键文件格式，它作为物理库描述格式，主要记录芯片物理设计相关信息。LEF文件既包含如最小线宽、布线层数、金属线间距等布局布线规则，也描述库单元（cell）的物理属性。</p>
                
                <div class="example-box">
                    <h3>LEF 文件的核心作用</h3>
                    <ul>
                        <li>定义集成电路工艺库的基本信息</li>
                        <li>描述标准单元和IP核的物理属性</li>
                        <li>指定布局布线规则和约束</li>
                        <li>抽象单元底层几何细节</li>
                        <li>为EDA工具提供工艺规则与单元物理模型</li>
                        <li>连接工艺库与EDA工具的核心数据格式</li>
                    </ul>
                </div>
                
                <h2>LEF 文件核心结构</h2>
                
                <h3>1. 头部信息</h3>
                <p>LEF文件的头部包含版本信息、单位定义和制造网格等基本信息。</p>
                <div class="code-block">
VERSION 5.7；<br>
BUSBITCHARS "[]";<br>
DIVIDERCHAR "/";<br>
UNITS<br>
  DATABASE MICRONS 2000；<br>
END UNITS<br>
MANUFACTURINGGRID 0.005；
                </div>
                <ul>
                    <li><span class="highlight">VERSION</span>: 指定LEF文件的版本号</li>
                    <li><span class="highlight">BUSBITCHARS</span>: 定义总线位字符，用于表示总线信号的位置</li>
                    <li><span class="highlight">DIVIDERCHAR</span>: 定义分隔符字符，用于在名称中分隔层次结构</li>
                    <li><span class="highlight">UNITS</span>: 定义数据库单位，例如1个数据库单位等于2000微米</li>
                    <li><span class="highlight">MANUFACTURINGGRID</span>: 定义制造网格的最小单位</li>
                </ul>
                
                <h3>2. 站点定义</h3>
                <p>站点（SITE）定义了芯片的基本单元布局模板。</p>
                <div class="code-block">
SITE CoreSite<br>
  SIZE 0.210 BY 1.050 ;<br>
  CLASS CORE ;<br>
  SYMMETRY Y ;<br>
END CoreSite
                </div>
                <ul>
                    <li><span class="highlight">SIZE</span>: 站点的大小，定义宽度和高度</li>
                    <li><span class="highlight">CLASS</span>: 站点类型，如CORE表示核心区域</li>
                    <li><span class="highlight">SYMMETRY</span>: 对称性，定义站点在X和/或Y方向的对称性</li>
                </ul>
                
                <h3>3. 图层定义</h3>
                <p>LEF文件定义了两类图层：切割层和布线层。</p>
                
                <h4>切割层（CUT）</h4>
                <div class="code-block">
LAYER CO<br>
  TYPE CUT ;<br>
END CO
                </div>
                <p>切割层用于表示接触孔或通孔，连接不同金属层。</p>
                
                <h4>布线层（ROUTING）</h4>
                <div class="code-block">
LAYER M1<br>
  TYPE ROUTING ;<br>
  DIRECTION HORIZONTAL ;<br>
  PITCH 0.15 0.150 ;<br>
  OFFSET 0.000 0.000 ;<br>
  WIDTH 0.050000 ;<br>
END M1
                </div>
                <ul>
                    <li><span class="highlight">TYPE</span>: 图层类型，ROUTING表示用于布线</li>
                    <li><span class="highlight">DIRECTION</span>: 布线方向，HORIZONTAL或VERTICAL</li>
                    <li><span class="highlight">PITCH</span>: 布线间距，定义金属线之间的最小距离</li>
                    <li><span class="highlight">OFFSET</span>: 布线偏移，定义布线网格的起始位置</li>
                    <li><span class="highlight">WIDTH</span>: 布线宽度，定义金属线的最小宽度</li>
                </ul>
                
                <div class="layer-info">
                    <div class="layer-item">
                        <strong>金属层示例</strong><br>
                        M1: 水平方向<br>
                        M2: 垂直方向<br>
                        M3: 水平方向<br>
                        交替排列
                    </div>
                    <div class="layer-item">
                        <strong>关键参数</strong><br>
                        间距(PITCH)<br>
                        宽度(WIDTH)<br>
                        方向(DIRECTION)<br>
                        偏移(OFFSET)
                    </div>
                </div>
                
                <h3>4. 宏单元定义</h3>
                <p>宏单元（MACRO）是由多个标准单元或功能模块组合而成的相对较大的功能单元。</p>
                
                <div class="example-box">
                    <h4>宏单元的特点</h4>
                    <ul>
                        <li><strong>功能独立性</strong>: 每个宏单元能独立完成特定功能</li>
                        <li><strong>布局整体性</strong>: 在布局布线时被当作一个整体处理</li>
                        <li><strong>可复用性</strong>: 可以在不同芯片设计中重复使用</li>
                        <li><strong>预集成逻辑</strong>: 内部已预先集成完整逻辑并预设引脚</li>
                    </ul>
                </div>
                
                <div class="code-block">
MACRO AN2_x0_0<br>
  CLASS CORE ;<br>
  FOREIGN AN2_x0_0 0.000 0.000 ;<br>
  ORIGIN 0.000 0.000 ;<br>
  SIZE 0.8400 BY 1.0500 ;<br>
  SYMMETRY X Y ;<br>
  SITE CoreSite ;<br>
  PIN Z<br>
    DIRECTION OUTPUT ;<br>
    PORT<br>
      LAYER M1 ;<br>
      RECT 0.7275 0.1500 0.8025 0.9000 ;<br>
      RECT 0.6975 0.1500 0.7275 0.3825 ;<br>
      RECT 0.6975 0.6675 0.7275 0.9000 ;<br>
    END<br>
  END Z<br>
END AN2_x0_0
                </div>
                
                <div class="macro-diagram">
                    <h4>宏单元结构示意图</h4>
                    <p>宏单元包含以下关键元素：</p>
                    <ul>
                        <li><strong>尺寸(SIZE)</strong>: 定义宏单元的宽度和高度</li>
                        <li><strong>原点(ORIGIN)</strong>: 定义宏单元的参考点</li>
                        <li><strong>引脚(PIN)</strong>: 定义输入输出接口</li>
                        <li><strong>障碍区域(OBS)</strong>: 定义不可用区域</li>
                    </ul>
                </div>
                
                <h4>引脚定义</h4>
                <p>引脚定义了宏单元与外部连接的接口。</p>
                <div class="code-block">
PIN Z<br>
  DIRECTION OUTPUT ;<br>
  PORT<br>
    LAYER M1 ;<br>
    RECT 0.7275 0.1500 0.8025 0.9000 ;<br>
  END<br>
END Z
                </div>
                <ul>
                    <li><span class="highlight">DIRECTION</span>: 引脚方向，如INPUT、OUTPUT、INOUT</li>
                    <li><span class="highlight">PORT</span>: 定义引脚的几何形状</li>
                    <li><span class="highlight">LAYER</span>: 引脚所在的金属层</li>
                    <li><span class="highlight">RECT</span>: 定义引脚形状的矩形区域</li>
                </ul>
                
                <h4>障碍区域定义</h4>
                <div class="code-block">
OBS<br>
  LAYER CO ;<br>
  RECT 0.7050 0.1800 0.7650 0.2400 ;<br>
  RECT 0.7050 0.8025 0.7650 0.8625 ;<br>
END
                </div>
                <p>障碍区域（OBS）定义了在布局中不可用的区域，通常用于保留空间或防止布线冲突。</p>
                
                <div class="task-section">
                    <h2 class="task-title">学生动手任务：LEF 文件解析与宏单元分析</h2>
                    <p>本任务旨在帮助学生深入理解LEF文件的结构和内容，通过实际操作掌握集成电路物理库的构成和分析方法。</p>
                    
                    <div class="step">
                        <span class="step-number">1</span>
                        <strong>任务准备</strong>
                        <p>获取必要的工具和文件：</p>
                        <ul>
                            <li>文本编辑器（VS Code、Sublime Text等）</li>
                            <li>Python编程环境</li>
                            <li>示例LEF文件（如cn.lef）</li>
                            <li>可视化工具（matplotlib、SVG编辑器等）</li>
                        </ul>
                    </div>
                    
                    <div class="step">
                        <span class="step-number">2</span>
                        <strong>LEF文件结构分析</strong>
                        <p>使用提供的LEF文件，分析以下内容：</p>
                        <ul>
                            <li>识别文件的版本信息和单位定义</li>
                            <li>分析制造网格的精度要求</li>
                            <li>统计站点(SITE)的类型和参数</li>
                            <li>识别所有图层(LAYER)的类型和属性</li>
                            <li>分析宏单元(MACRO)的结构和组成</li>
                        </ul>
                    </div>
                    
                    <div class="step">
                        <span class="step-number">3</span>
                        <strong>编写LEF解析器</strong>
                        <p>使用Python编写一个LEF文件解析器，实现以下功能：</p>
                        <ul>
                            <li>读取LEF文件并解析其层次结构</li>
                            <li>提取单位信息和制造网格参数</li>
                            <li>解析站点定义并建立站点数据库</li>
                            <li>提取所有图层信息并分类存储</li>
                            <li>解析宏单元定义，包括尺寸、引脚和障碍区域</li>
                        </ul>
                    </div>
                    
                    <div class="step">
                        <span class="step-number">4</span>
                        <strong>宏单元可视化</strong>
                        <p>基于解析的数据，创建以下可视化内容：</p>
                        <ul>
                            <li>绘制宏单元的边界轮廓</li>
                            <li>在宏单元内部标记所有引脚的位置和形状</li>
                            <li>使用不同颜色区分输入、输出和电源引脚</li>
                            <li>标注障碍区域(OBS)</li>
                            <li>显示引脚的金属层信息</li>
                            <li>创建多个宏单元的对比视图</li>
                        </ul>
                    </div>
                    
                    <div class="step">
                        <span class="step-number">5</span>
                        <strong>工艺规则分析</strong>
                        <p>基于解析的图层信息，完成以下分析：</p>
                        <ul>
                            <li>分析各金属层的布线方向和间距规则</li>
                            <li>计算不同金属层的布线密度容量</li>
                            <li>识别可能的布线冲突区域</li>
                            <li>分析宏单元引脚与布线层的匹配关系</li>
                            <li>评估设计规则检查(DRC)的关键参数</li>
                        </ul>
                    </div>
                    
                    <div class="step">
                        <span class="step-number">6</span>
                        <strong>综合报告</strong>
                        <p>撰写详细的实验报告，包括：</p>
                        <ul>
                            <li>LEF文件结构分析结果</li>
                            <li>解析器的设计和实现方法</li>
                            <li>宏单元可视化结果和分析</li>
                            <li>工艺规则符合性评估</li>
                            <li>代码实现和遇到的问题及解决方案</li>
                        </ul>
                    </div>
                    
                    <div class="note">
                        <strong>扩展挑战：</strong>尝试创建一个简单的标准单元LEF描述，包括定义单元尺寸、引脚位置和障碍区域，并与现有单元进行对比分析。
                    </div>
                </div>
                
                <h2>LEF与DEF的关系</h2>
                <p>LEF和DEF文件在集成电路设计中紧密配合：</p>
                <ul>
                    <li><strong>LEF提供库信息</strong>: 定义单元和工艺的物理特性</li>
                    <li><strong>DEF使用库信息</strong>: 描述具体设计中单元的布局和连接</li>
                    <li><strong>抽象级别不同</strong>: LEF是工艺库级别，DEF是设计实例级别</li>
                    <li><strong>相互依赖</strong>: DEF文件依赖于LEF文件中定义的单元和规则</li>
                </ul>
                
                <h2>教学要点总结</h2>
                <ul>
                    <li>LEF文件是集成电路物理设计的基础工艺库描述格式</li>
                    <li>理解LEF文件结构对于掌握IC设计流程至关重要</li>
                    <li>宏单元是复杂功能模块的抽象表示，具有重要设计价值</li>
                    <li>图层定义决定了布线的可行性和效率</li>
                    <li>通过实际解析和可视化LEF文件，学生可以深入理解工艺库的构成和使用方法</li>
                </ul>
            </div>
            
            <div class="sidebar">
                <h2>关键术语</h2>
                <ul>
                    <li><strong>LEF</strong>: Library Exchange Format</li>
                    <li><strong>MACRO</strong>: 宏单元</li>
                    <li><strong>SITE</strong>: 站点</li>
                    <li><strong>LAYER</strong>: 图层</li>
                    <li><strong>CUT</strong>: 切割层</li>
                    <li><strong>ROUTING</strong>: 布线层</li>
                    <li><strong>PIN</strong>: 引脚</li>
                    <li><strong>OBS</strong>: 障碍区域</li>
                    <li><strong>PITCH</strong>: 间距</li>
                    <li><strong>SYMMETRY</strong>: 对称性</li>
                </ul>
                
                <h2>图层类型</h2>
                <ul>
                    <li><strong>布线层(ROUTING)</strong>: 用于信号布线</li>
                    <li><strong>切割层(CUT)</strong>: 用于层间连接</li>
                    <li><strong>重叠层(OVERLAP)</strong>: 特殊用途</li>
                    <li><strong>阻抗层(IMPEDANCE)</strong>: 电气特性</li>
                    <li><strong>电源层(POWER)</strong>: 电源分布</li>
                </ul>
                
                <h2>引脚方向</h2>
                <ul>
                    <li><strong>INPUT</strong>: 输入引脚</li>
                    <li><strong>OUTPUT</strong>: 输出引脚</li>
                    <li><strong>INOUT</strong>: 双向引脚</li>
                    <li><strong>FEEDTHRU</strong>: 穿透引脚</li>
                    <li><strong>POWER</strong>: 电源引脚</li>
                    <li><strong>GROUND</strong>: 地线引脚</strong></li>
                </ul>
                
                <h2>评估标准</h2>
                <ul>
                    <li>LEF文件解析完整性 (25%)</li>
                    <li>宏单元可视化准确性 (25%)</li>
                    <li>工艺规则分析深度 (20%)</li>
                    <li>代码质量和文档 (20%)</li>
                    <li>报告完整性和洞察力 (10%)</li>
                </ul>
            </div>
        </div>
        
        <footer>
            <p>LEF 格式解析教学材料 &copy; 2023 - 集成电路设计教育</p>
        </footer>
    </div>
</body>
</html>